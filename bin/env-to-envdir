#!/usr/bin/env ruby

def main(argv = ARGV)
  env_file = argv.fetch(0)
  env_dir = argv.fetch(1)

  File.readlines(env_file).each do |line|
    key, value = line.strip.split('=', 2)
    key = key.sub(/^export\s+/, '')
    value = value.sub(/^['"]/, '').sub(/['"]$/, '')
    File.open(File.join(env_dir, key), 'w') do |f|
      f.puts(value)
    end
  end
end

main if $PROGRAM_NAME == __FILE__
